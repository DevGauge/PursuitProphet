{% extends "dashboard.html" %}
{% block main %}
<div class="loading dark-spinner">Loading...</div>
<div class="goal-detail-container">
    <form class="goal-detail-form" method="POST">
        {% if goal -%}
        {%- if 'task' not in request.path -%}
        <h1>{{ goal.goal }}</h1>
          <a href="{{ url_for('view_tasks', goal_id=goal.id) }}">
          <input class="standard-button" type="button" value="View Tasks ({{goal.tasks|length}})"> 
        {%- elif 'task' in request.path and 'new_subtask' not in request.path-%}
          <h1>{{ goal.task }}</h1>          
          <a href="{{ url_for('view_subtasks', title=goal.task, task_id=goal.id) }}">
          <input class="standard-button" type="button" value="View Subtasks ({{goal.subtasks|length}})">
        {% endif %}
        {%- endif %}
        </input></a>        
        {{ form.hidden_tag() }}
        {{ form.goal.label }} {{ form.goal() }}
        {%- if 'task' not in request.path -%}        
        {{ form.description.label }} {{ form.description() }}
        {% endif %}
        {{ form.target_date.label }} {{ form.target_date() }}
        {{ form.target_time.label }} {{ form.target_time() }}
        {{ form.submit(class="standard-button") }}        
    </form>
</div>
{% endblock %}
{% block scripts %}
<script>
  var loading = document.querySelector('.loading');
  // make loading .none on load
  document.addEventListener('DOMContentLoaded', function () {      
      loading.style.display = 'none';
  });
  function showLoading() {
      loading.style.display = 'block';
  }
  document.addEventListener('DOMContentLoaded', function () {
    {% if goal is not none %}
    url = '/view_tasks?goal_id={{ goal.id }}'
    console.log('url:', url)
    {% endif %}
  });
  function gotoUrl() {
    console.log('going to url:', url)
    window.replace(url, '_self')
  }
</script>
{% endblock %}
