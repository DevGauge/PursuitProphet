{% include 'task-view-base.html' %}
{% block titleContent %}
<h1><span class='highlight-text'>{{ subtitle }}</span></h1>
<h3><span class='highlight-text'>{{ title }}</span></h3>
{% endblock %}
{% block scripts %}
<script src="{{ url_for('static', filename='show_alert.js') }}"></script>
<script src="{{ url_for('static', filename='feature_value_request.js') }}"></script>
<script>
    const tempUserId = '{{ session["temp_user_id"] }}';    
    handleFirstTimeFeatureRequest('is_first_demo_subtask_gen', '<h1>Thanks for finishing the demo!</h1><p>To continue using Pursuit Prophet to achieve your dreams and explore exciting features such as chatting with your tasks, subtasks, and dreams, simply register an account by clicking the button below!', '{{ url_for_security("register") }}', 'Register an Account', tempUserId);
</script>
{% endblock %}
<script>
    // add click listeners to each goal card in order to generate subtasks
    document.querySelectorAll('.goal-card').forEach(function (goalCard) {
        goalCard.addEventListener('click', function () {
            var taskId = goalCard.getAttribute('data-task-id');

            fetch('/demo/generate_subtasks/10', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    'task_id': taskId,
                }),
            })
                .then(response => response.json())
                .then(data => {
                    // once the subtasks are generated, redirect to the new page
                    window.location.href = `/demo/display_subtasks/${taskId}`;
                })
                .catch((error) => {
                    console.error('Error:', error);
                });
        });
        document.addEventListener('DOMContentLoaded', function () {
            var loading = document.querySelector('.loading');

            goalCard.addEventListener('click', function () {
                loading.style.display = 'block';
            });
        });
    });